<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>BabyTalk - æ™ºèƒ½äº²å­è‹±è¯­</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { -webkit-tap-highlight-color: transparent; font-family: -apple-system, sans-serif; }
        .active-tab { border-bottom: 3px solid #6366f1; color: #6366f1; }
        .loading { animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: .5; } }
    </style>
</head>
<body class="bg-slate-50">

    <header class="bg-white shadow-sm sticky top-0 z-10 px-4 py-3 flex justify-between items-center">
        <h1 class="text-xl font-bold text-indigo-600">BabyTalk AI</h1>
        <select id="voice-select" class="text-xs bg-gray-100 px-2 py-1 rounded border">
            <option value="en-US">ğŸ‡ºğŸ‡¸ ç¾å¼å‘éŸ³</option>
            <option value="en-GB">ğŸ‡¬ğŸ‡§ è‹±å¼å‘éŸ³</option>
        </select>
    </header>

    <main class="pb-24">
        <section id="learn-section" class="p-4">
            <h2 class="text-lg font-semibold mb-3">åœºæ™¯æ‰“å¡</h2>
            <div class="space-y-3">
                <div class="bg-white p-4 rounded-xl shadow-sm border border-gray-100 flex justify-between items-center" onclick="speak('Good morning, sunshine! Did you sleep well?')">
                    <div>
                        <p class="text-gray-800 font-medium">Good morning, sunshine!</p>
                        <p class="text-sm text-gray-400">æ—©å®‰ï¼Œå°å¤ªé˜³ï¼ç¡å¾—å¥½å—ï¼Ÿ</p>
                    </div>
                    <span class="text-xl">ğŸ”Š</span>
                </div>
            </div>
        </section>

        <section id="ai-section" class="p-4 hidden">
            <div class="bg-indigo-600 rounded-2xl p-5 text-white mb-6 shadow-lg">
                <h2 class="text-lg font-bold mb-1">AI åœºæ™¯åŠ©æ‰‹</h2>
                <p class="text-xs opacity-80">è¾“å…¥ä¸­æ–‡ï¼Œç”Ÿæˆ5å¥åœ°é“äº²å­å£è¯­</p>
                <textarea id="user-input" class="w-full mt-3 p-3 rounded-xl text-gray-800 focus:outline-none" rows="3" placeholder="ä¾‹å¦‚ï¼šå®å®ä¸è‚¯ç©¿é‹å­..."></textarea>
                <button id="gen-btn" onclick="generateEnglish()" class="w-full mt-3 bg-yellow-400 text-indigo-900 font-bold py-3 rounded-xl shadow-md active:scale-95 transition">ç«‹å³ç”Ÿæˆ 5 å¥</button>
            </div>

            <div id="ai-results" class="space-y-3">
                </div>
        </section>
    </main>

    <nav class="fixed bottom-0 left-0 right-0 bg-white border-t flex justify-around py-3 shadow-2xl">
        <button onclick="switchTab('learn')" id="tab-learn" class="flex flex-col items-center active-tab">
            <span class="text-sm font-medium">å­¦ä¹ åº“</span>
        </button>
        <button onclick="switchTab('ai')" id="tab-ai" class="flex flex-col items-center text-gray-400">
            <span class="text-sm font-medium">AI åŠ©æ‰‹</span>
        </button>
    </nav>

    <script>
        // --- è¯·åœ¨è¿™é‡Œå¡«å…¥ä½ çš„ API KEY ---
        const MY_KEY = "sk-2c35c979013041c1a74138d6c96ae3cd"; 
        // ------------------------------

        function switchTab(type) {
            document.getElementById('learn-section').classList.toggle('hidden', type !== 'learn');
            document.getElementById('ai-section').classList.toggle('hidden', type !== 'ai');
            document.getElementById('tab-learn').classList.toggle('active-tab', type === 'learn');
            document.getElementById('tab-ai').classList.toggle('active-tab', type === 'ai');
        }

        function speak(text) {
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = document.getElementById('voice-select').value;
            utterance.rate = 0.9; // ç¨å¾®æ…¢ä¸€ç‚¹ç‚¹ï¼Œæ–¹ä¾¿æ–°æ‰‹å¬æ¸…
            window.speechSynthesis.speak(utterance);
        }

        async function generateEnglish() {
            const input = document.getElementById('user-input').value;
            const btn = document.getElementById('gen-btn');
            const resultArea = document.getElementById('ai-results');

            if (!input) return alert("è¯·è¾“å…¥åœºæ™¯è¯´æ˜å“¦ï¼");


            // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
            btn.disabled = true;
            btn.innerText = "AI æ­£åœ¨æ€è€ƒä¸­...";
            resultArea.innerHTML = '<div class="text-center text-gray-400 loading">AI æ­£åœ¨ä¸ºä½ å‡†å¤‡åœ°é“è¡¨è¾¾...</div>';

            try {
                const response = await fetch("https://api.deepseek.com/chat/completions", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                        "Authorization": `Bearer ${MY_KEY}`
                    },
                    body: JSON.stringify({
                        model: "deepseek-chat",
                        messages: [
                            { role: "system", content: "ä½ æ˜¯ä¸€ä½ç²¾é€šè‚²å„¿è‹±è¯­çš„ä¸“å®¶ã€‚è¯·æ ¹æ®ç”¨æˆ·çš„åœºæ™¯ï¼Œæä¾›5å¥ç®€å•ã€è‡ªç„¶ã€åœ°é“çš„äº²å­å£è¯­ã€‚æ¯å¥ä¸€è¡Œï¼Œæ ¼å¼ä¸ºï¼šè‹±æ–‡|ä¸­æ–‡ã€‚ä¸è¦è¯´åºŸè¯ã€‚" },
                            { role: "user", content: input }
                        ]
                    })
                });

                const data = await response.json();
                const content = data.choices[0].message.content;
                const lines = content.split('\n').filter(l => l.includes('|'));

                resultArea.innerHTML = ""; // æ¸…ç©ºåŠ è½½çŠ¶æ€
                lines.forEach(line => {
                    const [en, cn] = line.split('|');
                    const card = document.createElement('div');
                    card.className = "bg-white p-4 rounded-xl border-l-4 border-indigo-400 shadow-sm flex justify-between items-center active:bg-indigo-50";
                    card.onclick = () => speak(en);
                    card.innerHTML = `<div><p class="text-gray-800 font-medium">${en.trim()}</p><p class="text-xs text-gray-400">${cn.trim()}</p></div><span class="text-lg">ğŸ”Š</span>`;
                    resultArea.appendChild(card);
                });

            } catch (error) {
                alert("å‡ºé”™å•¦ï¼Œè¯·æ£€æŸ¥ç½‘ç»œæˆ– Key æ˜¯å¦æ­£ç¡®ï¼");
                console.error(error);
            } finally {
                btn.disabled = false;
                btn.innerText = "ç«‹å³ç”Ÿæˆ 5 å¥";
            }
        }
    </script>
</body>
</html>